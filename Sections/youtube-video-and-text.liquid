{%- style -%}
    .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    background-color: var(--bg-color);
    }
    .yt-videos-section h3 {
    font-size: 20px;
    margin: 0 auto 15px auto;
    }
    @media screen and (min-width: 769px) {
    .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    }
    }
    @media (max-width: 768px) {
    .yt-videos-section h3 {
    font-size: 16px;
    }
    }
{%- endstyle -%}

<div class="section-{{ section.id }}-padding" style="--bg-color: {{ section.settings.background | default: 'transparent;' }};">
    <div class="page-width">
        {%- if section.settings.title != blank -%}
            <div class="section-header">
                <p class="h2 text-center">{{ section.settings.title | escape }}</p>
            </div>
        {%- endif -%}

        {%  for block in section.blocks %}

            {%- liquid
                assign videoAlignmentClass = 'video-' | append: block.settings.video_alignment
            -%}

            <div class="grid grid--uniform flex-grid justify-center grid--flush-bottom">

                <div class="grid__item medium-up--seven-twelfths small--one-whole text-cell">
                    {%- if block.settings.title != blank -%}
                        <h3>{{ block.settings.title }}</h3>
                    {%- endif -%}
                    {%- if block.settings.title != description -%}
                        <p>{{ block.settings.description }}</p>
                    {%- endif -%}
                </div>

                <div class="grid__item medium-up--five-twelfths small--one-whole {{ videoAlignmentClass }}">
                    <div class="player-embed" data-youtube="{{ block.settings.video_url.id }}">
                        <img src="https://i3.ytimg.com/vi/{{ block.settings.video_url.id }}/hqdefault.jpg" alt="" loading="lazy">
                        <div class="button-yt">
                            {% render 'icon-yt' %}
                        </div>
                    </div>
                </div>

            </div>
        {% endfor %}
        {%- if section.settings.button_label != blank and section.settings.button_link != blank -%}
            <div class="text-center bottom-button">
                <a href="{{ section.settings.button_link }}" id="{{ section.settings.button_id }}" class="btn btn-sm-100">
                    {{ section.settings.button_label }}
                </a>
            </div>
        {%- endif -%}
    </div>
</div>

<script>
    document.querySelectorAll('.player-embed .button-yt').forEach(e=> {
        var parent = e.parentNode;
        var id = parent.dataset.youtube;

        var player = `<iframe
        width="1223" height="688"
        src="https://www.youtube.com/embed/${id}?autoplay=1"
        frameborder="0"
        allow="autoplay"
        allow="accelerometer; autoplay;
        clipboard-write;
        encrypted-media; gyroscope;
        picture-in-picture;
        web-share" allowfullscreen></iframe>`

        e.addEventListener('click', ()=> {
            parent.innerHTML = '';
            parent.insertAdjacentHTML('afterbegin', player)
        })
    })
</script>

{% schema %}
{
"name": "Youtube videos with text",
"class": "yt-videos-section",
"settings": [
{
"type": "text",
"id": "title",
"label": "Heading",
"default": "Large image with text box"
},
{
"type": "text",
"id": "button_label",
"label": "Button label"
},
{
"type": "url",
"id": "button_link",
"label": "Button link"
},
{
"type": "text",
"id": "button_id",
"label": "Button ID"
},
{
"type": "color",
"id": "background",
"label": "Background color"
},
{
"type": "header",
"content": "Section Padding"
},
{
"type": "range",
"id": "padding_top",
"min": 0,
"max": 100,
"step": 4,
"unit": "px",
"label": "Padding top",
"default": 36
},
{
"type": "range",
"id": "padding_bottom",
"min": 0,
"max": 100,
"step": 4,
"unit": "px",
"label": "Padding bottom",
"default": 36
}
],
"blocks": [
{
"type": "item",
"name": "Item",
"settings": [
{
"type": "video_url",
"id": "video_url",
"accept": [
"youtube"
],
"default": "https://www.youtube.com/watch?v=_9VUPq3SxOc",
"label": "URL",
"info": "Video plays in the page."
},
{
"type": "text",
"id": "title",
"label": "Title"
},
{
"type": "select",
"id": "video_alignment",
"label": "Video Alignment",
"default": "left",
"options": [
{
"value": "left",
"label": "Left column"
},
{
"value": "right",
"label": "Right column"
}
]
},
{
"type": "text",
"id": "description",
"label": "Description"
}
]
}
],
"presets": [
{
"name": "Youtube videos with text"
}
]
}
{% endschema %}
<style>
    #shopify-section-youtube-video-and-text .grid {
        border-top: 1px solid gray;
        padding: 40px 20px;
    }
    #shopify-section-youtube-video-and-text .grid:first-childXXX {
        border-top: 0 none;
    }
    #shopify-section-youtube-video-and-text .grid .text-cell {
        text-align: center;
    }

    @media (min-width:769px) {
        #shopify-section-youtube-video-and-text .grid .text-cell {
            order: 2;
        }
        #shopify-section-youtube-video-and-text .grid .video-left {
            order: 1;
        }
        #shopify-section-youtube-video-and-text .grid .video-right {
            order: 3;
        }
    }

    @media (min-width:1025px) {
        #shopify-section-youtube-video-and-text .grid .text-cell {
            padding-top: 25px;
        }
    }
</style>
